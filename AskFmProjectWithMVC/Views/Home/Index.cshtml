@model UserWithFollowingAnswerViewModel

@{
    ViewData["Title"] = "Home Page";
}

@if (Model.FollowingAns.Count == 0)
{
    <h3 class="text-center">There is No Answer To Show</h3>
}


@foreach (var item in Model.FollowingAns)
{

    <div class="card">

        <p class="question">@item.question.question_text <a asp-action="profile" asp-controller="user" asp-route-id="@item.question.user_who_ask_id"><small class="asker">@item.question.user_who_ask?.username</small></a></p>
        <footer class="timestamp">
            <img src="/Images/@item.question.user_who_answer.image" class="image_answer"><span class="user_answer">@item.question.user_who_answer.username</span><br /><cite class="source" title="Source Title">@item.question.post_date</cite>
        </footer>
        <p class="answer">@item.answer_text</p>
        <button  class="love-button">
            <i onclick="addLike(@item.id, 'a')" id="emptyLove_@item.id" class="far fa-heart"></i>
            <i id="fillLove_@item.id" onclick="addLike(@item.id, 'r')" class="disapear fas fa-heart"></i>
            <small class="numberOfLikes numberOfLikes_@item.id">@item.likeCount</small>
        </button>
    </div>

}

@section scripts {
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js"></script>
    <script>
        function addLike(id, flag) {
            var counter = document.getElementsByClassName("numberOfLikes_" + id)[0];
            let count = Number(counter.innerHTML);
            if (flag == 'a') {
                fetch("/like/addLike?answerId=" + id).then(res => {
                    count++;
                    counter.innerHTML = count.toString();
                }).catch();
            } else if(flag == 'r') {
                fetch("/like/removeLike?answerId=" + id).then(res => {
                    count--;
                    counter.innerHTML = count.toString();
                }).catch();
            }
            counter.innerHTML = count.toString();
            var likeBtn = document.getElementById("fillLove_" + id);
            var emptyBtn = document.getElementById("emptyLove_" + id);
            likeBtn.classList.toggle("disapear");
            emptyBtn.classList.toggle("disapear");
        }
    </script>
}

@section styles {
    <link rel="stylesheet" href="~/css/profile.css" asp-append-version="true" />
    <style>
        .disapear {
            display: none !important;
        }
    </style>
}